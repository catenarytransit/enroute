---
import ConfigModalClient from "../components/config/modal";
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
			rel="stylesheet"
		/>

		<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
		<title>Catenary Enroute</title>
		<script src="../styles/global.css"></script>
		<script is:inline>
			// Apply font preference immediately to prevent FOUC
			const font = localStorage.getItem("enroute_font");
			if (font === "nimbus") {
				document.documentElement.style.setProperty(
					"--font-main",
					"var(--font-nimbus)",
				);
			} else if (font === "noto") {
				document.documentElement.style.setProperty(
					"--font-main",
					"var(--font-noto)",
				);
			} else if (font === "fira") {
				document.documentElement.style.setProperty(
					"--font-main",
					"var(--font-fira)",
				);
			} else if (font === "jetbrains_mono") {
				document.documentElement.style.setProperty(
					"--font-main",
					"var(--font-jetbrains-mono)",
				);
			} else {
				// Default to Barlow
				document.documentElement.style.setProperty(
					"--font-main",
					"var(--font-barlow)",
				);
			}

			// Apply compact mode
			const compactMode = localStorage.getItem("enroute_compact_mode") === "true";
			if (compactMode) {
				document.documentElement.classList.add("compact-mode");
			}

			// Apply theme preference
			const theme = localStorage.getItem("enroute_theme") || "default";
			const root = document.documentElement;

			switch (theme) {
				case "blue_white": // White on Blue #0220fa
					root.style.setProperty("--catenary-background", "#0000fe");
					root.style.setProperty("--catenary-darksky", "#0000fe");
					root.style.setProperty("--catenary-seashore", "#ffffff");
					root.style.setProperty("--catenary-text", "#ffffff");
					break;
				case "ns_light": // NS Light #1e2657 on White
					root.style.setProperty("--catenary-background", "#ffffff");
					root.style.setProperty("--catenary-darksky", "#ffffff");
					root.style.setProperty("--catenary-seashore", "#003082");
					root.style.setProperty("--catenary-text", "#003082");
					break;
				case "ns_dark": // NS Dark White on #1e2657
					root.style.setProperty("--catenary-background", "#003082");
					root.style.setProperty("--catenary-darksky", "#003082");
					root.style.setProperty("--catenary-seashore", "#ffffff");
					root.style.setProperty("--catenary-text", "#ffffff");
					break;
				case "midnight": // Midnight (White on Black)
					root.style.setProperty("--catenary-background", "#000000");
					root.style.setProperty("--catenary-darksky", "#000000");
					root.style.setProperty("--catenary-seashore", "#ffffff");
					root.style.setProperty("--catenary-text", "#ffffff");
					break;
				default: // Default Catenary
					// Variables are already set in CSS, but explicit reset helps if switching
					root.style.setProperty("--catenary-background", "#06121F");
					root.style.setProperty("--catenary-darksky", "#0A233F");
					root.style.setProperty("--catenary-seashore", "#42A7C5");
					root.style.setProperty("--catenary-text", "#ffffff");
					break;
			}
		</script>
		<slot name="head" />
	</head>
	<body>
		<ConfigModalClient client:load="react" />
		<slot />
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
